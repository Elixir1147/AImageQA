// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum ArticleType {
  Question
  Answer
}

model Users {
  userName    String       @id
  mailAddress String       @unique
  password    String
  profile     String       @default("")
  alive       Boolean      @default(true)
  Articles    Articles[]
  Evaluation  Evaluation[]
  Comments    Comments[]
  BookMarks   BookMarks[]
}

model Questions {
  questionId     String           @id @default(uuid()) @db.Uuid
  title          String
  viewNumber     Int              @default(0)
  restricted     Boolean
  Articles       Articles[]
  BookMarks      BookMarks[]
  QuestionToTags QuestionToTags[]
}

model Articles {
  articleId   String       @id @default(uuid()) @db.Uuid
  question    Questions    @relation(fields: [questionId], references: [questionId])
  questionId  String       @db.Uuid
  user        Users        @relation(fields: [userName], references: [userName])
  userName    String
  articleType ArticleType
  atricle     String
  postDate    DateTime     @default(now())
  updatedDate DateTime     @updatedAt
  Evaluation  Evaluation[]
  Comments    Comments[]
  Images      Images[]
}

model Evaluation {
  user       Users    @relation(fields: [userName], references: [userName])
  userName   String
  article    Articles @relation(fields: [articleId], references: [articleId])
  articleId  String   @db.Uuid
  evaluation Int      @default(0)

  @@id([userName, articleId])
}

model Comments {
  commentId   String   @id @default(uuid()) @db.Uuid
  user        Users    @relation(fields: [userName], references: [userName])
  userName    String
  article     Articles @relation(fields: [articleId], references: [articleId])
  articleId   String   @db.Uuid
  comment     String
  commentDate DateTime @default(now())
  updatedDate DateTime @updatedAt
}

model BookMarks {
  user       Users     @relation(fields: [userName], references: [userName])
  userName   String
  question   Questions @relation(fields: [questionId], references: [questionId])
  questionId String    @db.Uuid

  @@id([userName, questionId])
}

model Tags {
  tagId          String           @id @default(uuid()) @db.Uuid
  name           String
  QuestionToTags QuestionToTags[]
}

model QuestionToTags {
  question   Questions @relation(fields: [questionId], references: [questionId])
  questionId String    @db.Uuid
  tag        Tags      @relation(fields: [tagId], references: [tagId])
  tagId      String    @db.Uuid

  @@id([questionId, tagId])
}

model Images {
  imageId   String   @id @default(uuid()) @db.Uuid
  article   Articles @relation(fields: [articleId], references: [articleId])
  articleId String   @db.Uuid
  place     String
}
